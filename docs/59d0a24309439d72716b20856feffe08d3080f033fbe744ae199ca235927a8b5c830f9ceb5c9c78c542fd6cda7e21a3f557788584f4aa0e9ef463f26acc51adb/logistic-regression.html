<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Logistic Regression | MULTIVARIATE DATA ANALYSIS TOOLS FOR AGRICULTURAL RESEARCH</title>
<meta name="author" content="Dr. PRATHEESH P GOPINATH">
<meta name="description" content="Logistic regression is a statistical method used for predicting the category or class of individuals based on one or multiple predictor variables (denoted as “x”). It is specifically designed for...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Chapter 6 Logistic Regression | MULTIVARIATE DATA ANALYSIS TOOLS FOR AGRICULTURAL RESEARCH">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.PNG">
<meta property="og:description" content="Logistic regression is a statistical method used for predicting the category or class of individuals based on one or multiple predictor variables (denoted as “x”). It is specifically designed for...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Logistic Regression | MULTIVARIATE DATA ANALYSIS TOOLS FOR AGRICULTURAL RESEARCH">
<meta name="twitter:description" content="Logistic regression is a statistical method used for predicting the category or class of individuals based on one or multiple predictor variables (denoted as “x”). It is specifically designed for...">
<meta name="twitter:image" content="/images/cover.PNG">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.29/datatables.js"></script><link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="libs/dt-ext-buttons-1.13.4/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.13.4/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.13.4/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.13.4/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.13.4/js/buttons.print.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">MULTIVARIATE DATA ANALYSIS TOOLS FOR AGRICULTURAL RESEARCH</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="r-and-r-studio.html"><span class="header-section-number">1</span> R and R studio</a></li>
<li><a class="" href="import.html"><span class="header-section-number">2</span> Importing data files in R</a></li>
<li><a class="" href="principal-component-analysis-pca.html"><span class="header-section-number">3</span> Principal Component Analysis (PCA)</a></li>
<li><a class="" href="exploratory-factor-analysis.html"><span class="header-section-number">4</span> Exploratory Factor Analysis</a></li>
<li><a class="" href="cluster-analysis.html"><span class="header-section-number">5</span> Cluster Analysis</a></li>
<li><a class="active" href="logistic-regression.html"><span class="header-section-number">6</span> Logistic Regression</a></li>
<li><a class="" href="canonical-correlation.html"><span class="header-section-number">7</span> Canonical Correlation</a></li>
<li><a class="" href="manova.html"><span class="header-section-number">8</span> MANOVA</a></li>
<li><a class="" href="references.html"><span class="header-section-number">9</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="logistic-regression" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h1>
<p>Logistic regression is a statistical method used for predicting the category or class of individuals based on one or multiple predictor variables (denoted as “x”). It is specifically designed for modeling a binary outcome, where the response variable can take one of two possible values, such as 0 or 1, yes or no, or diseased or non-diseased.</p>
<p>This modeling technique is part of the Generalized Linear Model (GLM) family, which extends the principles of linear regression to handle a broader range of data scenarios. Logistic regression is also known by various names, including <strong>binary logistic regression</strong>, <strong>binomial logistic regression</strong>, and the <strong>logit model</strong>.</p>
<p>It’s essential to note that logistic regression doesn’t directly provide class labels for observations. Instead, it estimates the probability (denoted as “p”) of an observation belonging to a particular class. This probability value falls within the range of 0 to 1. To determine the class assignment, you must select a threshold probability. By default, this threshold is often set at p = 0.5, but in practice, the choice of the threshold should be determined based on the specific goals of the analysis.<br>
The standard logistic regression function is represented as:</p>
<p><span class="math display">\[
p = \frac{e^{y}}{1 + e^{y}}
\]</span>
or more simply:
<span class="math display">\[
p = \frac{1}{1 + e^{-y}}
\]</span>
Where:</p>
<ul>
<li><p><span class="math inline">\(y = b_0 + b_1 \cdot x\)</span></p></li>
<li><p><span class="math inline">\(e\)</span> represents the exponential function</p></li>
<li><p><span class="math inline">\(p\)</span> represents the probability of an event occurring given <span class="math inline">\(x\)</span>, denoted as<br><span class="math inline">\(p(\text{{event}}=1|x)\)</span> and abbreviated as <span class="math inline">\(p(x)\)</span>, so<br><span class="math display">\[
p(x) = \frac{1}{1 + e^{-(b_0 + b_1 \cdot x)}}
\]</span><br>
By a bit of manipulation, it can be demonstrated that:
<span class="math display">\[
\frac{p}{1-p} = e^{b_0 + b_1 \cdot x}
\]</span></p></li>
</ul>
<p>Taking the logarithm of both sides, we get the formula as a linear combination of predictors:</p>
<p><span class="math display">\[
\log\left(\frac{p}{1-p}\right) = b_0 + b_1 \cdot x
\]</span></p>
<p>When dealing with multiple predictor variables, the logistic function takes the form:</p>
<p><span class="math display">\[
\log\left(\frac{p}{1-p}\right) = b_0 + b_1 \cdot x_1 + b_2 \cdot x_2 + \ldots + b_n \cdot x_n
\]</span></p>
<p>Here, <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are the regression beta coefficients. A positive <span class="math inline">\(b_1\)</span> indicates that an increase in <span class="math inline">\(x\)</span> will be associated with an increase in <span class="math inline">\(p\)</span>, while a negative <span class="math inline">\(b_1\)</span> indicates that an increase in <span class="math inline">\(x\)</span> will be associated with a decrease in <span class="math inline">\(p\)</span>.</p>
<p>The term <span class="math inline">\(\log\left(\frac{p}{1-p}\right)\)</span> is known as the logarithm of the odds, often referred to as the log-odds or logit. The odds represent the likelihood of an event occurring and can be thought of as the ratio of “successes” to “non-successes”. Technically, odds are calculated as the probability of an event divided by the probability that the event will not occur. For instance, if the probability of being diabetes-positive is 0.5, the probability of “not being positive” is <span class="math inline">\(1 - 0.5 = 0.5\)</span>, and the odds are 1.0.
You can calculate the probability from the odds using the formula:
<span class="math display">\[  
p = \frac{\text{Odds}}{1 + \text{Odds}}
\]</span></p>
<div id="practical-example-2" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Practical Example<a class="anchor" aria-label="anchor" href="#practical-example-2"><i class="fas fa-link"></i></a>
</h2>
<p>Before proceeding to the sections install following packages: <code>texreg</code>, <code>ggplot2</code>,<code>dplyr</code></p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install required packages</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"texreg"</span>, <span class="st">"ggplot2"</span>,<span class="st">"dplyr"</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
<p>We will be using a part of <code>PimaIndiansDiabetes2</code> dataset in <code>mlbench</code> package. You can download and view the model dataset below.</p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-091cfc94054478e58731" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-091cfc94054478e58731">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392"],[1,0,3,2,1,5,0,1,1,3,11,10,1,13,3,3,4,4,3,9,1,1,5,8,7,7,0,0,2,1,4,2,5,4,7,2,2,15,4,7,2,6,1,6,1,1,1,4,3,0,3,8,1,7,4,0,2,1,3,1,1,4,3,2,2,0,0,5,2,4,2,1,9,1,2,1,2,17,7,0,6,3,6,1,2,8,0,0,8,1,8,5,9,5,3,4,4,2,6,8,1,0,9,12,5,6,0,7,1,1,4,0,6,1,3,7,4,6,2,0,9,2,12,1,11,3,5,2,1,2,0,2,10,7,7,5,1,4,5,0,0,2,1,6,2,0,14,2,5,2,10,0,0,2,0,2,3,2,3,3,4,13,1,1,2,6,2,1,0,9,1,1,8,1,3,1,1,12,1,5,4,5,3,1,3,0,2,2,12,0,1,0,1,1,1,1,1,5,3,1,1,4,2,3,5,2,1,1,1,1,0,3,3,1,2,0,8,4,1,0,1,3,1,2,4,0,1,0,0,0,1,0,2,5,10,9,9,8,0,0,0,6,2,7,8,3,4,0,0,1,0,2,4,2,7,6,2,7,0,1,2,0,3,3,9,6,2,3,1,3,0,2,1,1,0,3,8,3,4,1,8,5,4,1,3,1,1,7,0,1,6,2,1,6,4,0,3,2,1,1,6,8,3,2,2,6,0,1,1,7,1,1,0,1,3,3,7,11,2,2,0,4,0,1,2,7,1,0,3,2,1,0,11,1,1,5,1,2,2,1,3,8,9,1,6,9,6,10,3,2,2,0,2,1,1,2,7,7,3,4,2,4,2,2,3,5,0,7,3,1,1,1,5,1,3,2,2,0,2,11,3,1,13,12,1,3,1,0,1,2,10,5],[89,137,78,197,189,166,118,103,115,126,143,125,97,145,158,88,103,111,180,171,103,101,88,176,150,187,100,105,141,95,146,100,139,129,83,110,100,136,123,81,142,144,71,93,122,81,126,144,83,95,171,155,89,160,99,162,107,88,120,118,117,173,170,96,125,100,93,105,108,154,106,136,156,153,99,109,88,163,102,114,104,111,134,79,75,179,129,119,181,128,109,139,123,158,107,109,148,99,103,196,96,140,112,151,109,125,177,142,100,87,197,117,134,79,74,181,91,119,146,165,124,90,92,193,155,191,96,108,71,100,104,108,129,133,136,155,119,96,108,78,107,128,128,151,146,126,100,144,77,120,161,137,128,124,106,155,113,112,99,115,129,152,157,122,102,105,87,95,165,152,130,95,126,139,99,90,125,88,196,189,147,99,81,133,173,84,105,122,140,98,87,93,107,109,90,125,119,144,100,100,131,116,127,96,136,123,172,112,143,143,138,173,129,119,94,102,151,184,181,135,95,89,80,83,117,180,100,95,104,120,82,91,100,86,148,134,120,74,124,74,97,154,105,114,126,158,85,84,135,139,173,83,125,81,195,154,117,94,180,130,84,139,99,163,145,129,68,124,97,116,117,122,86,77,127,129,100,128,84,88,186,187,131,164,84,88,84,124,198,87,99,95,99,92,154,121,111,98,143,119,108,124,176,112,82,123,188,89,109,150,181,92,152,111,106,174,168,138,68,112,94,90,102,128,94,97,100,102,103,157,167,179,136,91,117,123,106,155,101,120,80,167,145,112,98,154,165,68,123,101,56,95,129,140,144,121,129,142,169,127,122,110,127,93,158,126,134,187,173,108,114,149,117,116,130,174,106,126,99,120,102,109,153,100,81,187,121,181,128,88,101,121],[66,40,50,70,60,72,84,30,70,88,94,70,66,82,76,58,60,72,64,110,80,50,66,90,66,68,88,64,58,66,85,66,64,86,78,74,68,70,80,78,82,72,48,50,90,72,56,58,58,85,72,62,76,54,76,76,74,30,70,58,88,70,64,68,60,70,60,72,52,62,64,74,86,82,52,56,74,72,74,80,74,90,70,60,64,72,110,64,68,98,76,80,70,84,62,64,60,70,72,76,64,65,82,70,62,68,60,60,66,78,70,80,80,80,68,84,70,50,76,90,70,80,62,50,76,68,74,62,78,70,64,62,76,88,74,84,86,56,72,88,62,78,48,62,70,84,78,58,82,76,68,68,68,68,70,74,50,68,80,66,60,90,72,64,86,70,58,60,76,78,70,74,88,46,62,62,50,74,76,64,74,54,86,102,82,64,58,52,82,82,60,100,72,60,62,70,54,82,68,66,64,72,58,56,84,48,68,72,84,74,60,84,64,88,68,64,78,78,64,94,82,74,74,66,64,78,72,80,64,74,64,68,54,68,84,74,72,70,56,52,64,78,80,76,74,70,58,82,68,62,78,65,70,72,70,74,90,64,90,60,50,62,54,70,88,90,70,80,64,74,66,60,66,56,80,92,74,72,90,78,90,76,68,82,68,62,64,70,66,68,60,54,72,62,72,66,58,60,86,44,44,76,86,78,52,72,82,24,38,78,78,62,82,62,54,58,88,74,62,86,70,88,78,82,76,76,74,86,72,74,74,50,84,54,60,74,70,52,58,80,82,106,80,80,58,78,68,106,100,58,56,64,74,74,82,70,68,90,74,88,76,76,46,64,64,78,58,50,78,60,66,68,86,78,78,88,56,86,60,80,44,58,88,84,74,70,78,88,88,58,76,72],[23,35,32,45,23,19,47,38,30,41,33,26,15,19,36,11,33,47,25,24,11,15,21,34,42,39,60,41,34,13,27,20,35,20,26,29,25,32,15,40,18,27,18,30,51,18,29,28,31,25,33,26,34,32,15,56,30,42,30,36,24,14,37,13,20,26,25,29,26,31,35,50,28,42,15,21,19,41,40,34,18,12,23,42,24,42,46,18,36,41,39,35,44,41,13,44,27,16,32,29,27,26,32,40,41,30,29,33,15,27,39,31,37,25,28,21,32,22,35,33,33,14,7,16,28,15,18,32,50,52,23,10,28,15,26,44,39,17,43,29,30,37,45,31,38,29,25,33,41,37,23,14,19,28,37,17,10,22,11,39,12,33,21,32,36,32,16,18,43,34,13,21,36,19,19,12,40,40,36,33,25,28,16,28,48,22,40,43,43,15,37,39,30,8,18,24,13,26,23,29,14,12,24,34,41,32,49,30,23,22,35,33,29,41,18,46,32,39,30,46,25,16,11,23,27,63,12,45,37,18,13,32,28,28,48,33,22,40,13,10,36,41,45,17,38,30,22,31,42,41,32,28,18,15,33,32,19,25,26,23,23,17,19,18,34,7,32,33,19,15,31,18,52,30,37,49,40,25,23,29,35,27,21,43,30,24,23,33,32,34,19,14,30,32,29,30,31,17,30,47,20,24,27,50,22,45,14,19,18,29,42,25,39,13,21,22,42,26,13,42,27,47,40,17,18,32,12,17,30,35,17,36,35,25,23,40,28,27,35,48,31,46,46,45,33,30,26,23,35,17,28,39,26,26,46,32,49,24,19,11,27,20,21,32,13,27,20,33,39,46,36,29,30,29,23,37,27,27,17,37,20,18,37,33,41,22,39,44,39,26,48,23],[94,168,88,543,846,175,230,83,96,235,146,115,140,110,245,54,192,207,70,240,82,36,23,300,342,304,110,142,128,38,100,90,140,270,71,125,71,110,176,48,64,228,76,64,220,40,152,140,18,36,135,495,37,175,51,100,100,99,135,94,145,168,225,49,140,50,92,325,63,284,119,204,155,485,94,135,53,114,105,285,156,78,130,48,55,130,130,92,495,58,114,160,94,210,48,99,318,44,190,280,87,130,175,271,129,120,478,190,56,32,744,53,370,37,45,192,88,176,194,680,402,55,258,375,150,130,67,56,45,57,116,278,122,155,135,545,220,49,75,40,74,182,194,120,360,215,184,135,42,105,132,148,180,205,148,96,85,94,64,140,231,29,168,156,120,68,52,58,255,171,105,73,108,83,74,43,167,54,249,325,293,83,66,140,465,66,94,158,325,84,75,72,82,182,59,110,50,285,81,196,415,87,275,115,88,165,579,176,310,61,167,474,115,170,76,78,210,277,180,145,180,85,60,50,120,14,70,92,64,63,95,210,105,71,237,60,56,49,105,36,100,140,191,110,75,328,49,125,250,480,265,66,122,76,145,193,71,79,90,170,76,210,86,105,165,326,66,130,82,105,188,106,65,56,210,155,215,190,56,76,225,207,166,67,106,44,115,215,274,77,54,88,18,126,126,165,44,120,330,63,130,600,156,140,115,230,185,25,120,126,293,41,272,182,158,194,321,144,15,160,115,54,90,183,66,91,46,105,152,440,144,159,130,100,106,77,135,540,90,200,70,231,130,132,190,100,168,49,240,265,45,105,205,180,180,95,125,480,125,155,200,100,335,160,387,22,291,392,185,178,200,127,105,180,79,120,165,120,160,150,94,116,140,105,57,200,74,510,110,16,180,112],[28.1,43.1,31,30.5,30.1,25.8,45.8,43.3,34.6,39.3,36.6,31.1,23.2,22.2,31.6,24.8,24,37.1,34,45.4,19.4,24.2,24.4,33.7,34.7,37.7,46.8,41.5,25.4,19.6,28.9,32.9,28.6,35.1,29.3,32.4,38.5,37.1,32,46.7,24.7,33.9,20.4,28.7,49.7,26.6,28.7,29.5,34.3,37.4,33.3,34,31.2,30.5,23.2,53.2,33.6,55,42.9,33.3,34.5,29.7,34.5,21.1,33.8,30.8,28.7,36.9,32.5,32.8,30.5,37.4,34.3,40.6,24.6,25.2,29,40.9,37.2,44.2,29.9,28.4,35.4,43.5,29.7,32.7,67.09999999999999,34.9,30.1,32,27.9,31.6,33.1,39.4,22.9,34.8,30.9,20.4,37.7,37.5,33.2,42.6,34.2,41.8,35.8,30,34.6,28.8,23.6,34.6,36.7,45.2,46.2,25.4,29.7,35.9,33.1,27.1,38.2,52.3,35.4,24.4,27.6,25.9,33.3,30.9,33.6,25.2,33.2,40.5,27.8,25.3,35.9,32.4,26,38.7,45.6,20.8,36.1,36.9,36.6,43.3,40.5,35.5,28,30.7,36.6,31.6,35.8,39.7,25.5,24.8,30.5,32.9,39.4,26.6,29.5,34.1,19.3,38.1,27.5,26.8,25.6,35.1,45.5,30.8,32.7,23.9,47.9,34.2,25.9,25.9,38.5,28.7,21.8,27.2,33.3,35.3,36.5,31.2,34.9,34,27.5,32.8,38.4,35.8,34.9,36.2,39.2,25.2,37.2,43.4,30.8,25.4,25.1,24.3,22.3,32,31.6,32,23.7,22.1,27.7,24.7,35,42.1,42.4,34.4,42.4,26.2,34.6,35.7,26.4,45.3,26,40.6,42.9,37,34.1,40.6,35,30.4,30,32.2,33.2,59.4,25.3,36.5,33.6,30.5,21.2,39.9,37.8,30.2,37.6,25.9,20.8,35.3,21.8,27.8,36.8,46.1,33.7,23.8,25.9,35.5,27.8,38.2,42.3,40.7,46.5,36.8,28.9,30.1,25.1,29.3,25.2,33.3,36.5,28.6,30.4,22.1,25.6,31.6,30.3,19.6,25,33.2,18.2,26.3,30.8,29.8,41.3,33.3,36.3,36.4,39.4,32.4,39.5,32,34.5,43.6,33.1,32.8,31.9,29.9,36.9,25.5,41.3,37.6,26.9,26.1,38.6,32,31.3,34.3,29.5,34.7,30.1,35.5,24,28.7,33.3,39.4,28.5,33.6,32,27.8,23.1,35.2,40,19.5,41.5,24,30.9,32.9,38.2,36.1,20.1,38.4,43.5,37.7,34.5,27.5,31.6,40.9,19.5,29.3,27.6,39.4,23.4,37.8,28.3,25.2,33.8,34.1,34.2,38.7,21.8,38.9,34.2,37.6,37.9,34.8,34,30.9,33.6,35.5,57.3,24.2,24.2,44.6,33.2,24.1,46.1,39.1,38.5,30.4,29.9,34.5,35.9,28.4,34.4,38,31.2,29.6,26.4,33.9,33.8,35.5,38.1,29.3,39.1,36.1,28.4,44.5,29,27.4,36.6,42.3,30.8,28.5,40.6,30,46.3,36.4,39,43.3,36.5,28.4,32.9,26.2],[0.167,2.288,0.248,0.158,0.398,0.587,0.551,0.183,0.529,0.704,0.254,0.205,0.487,0.245,0.851,0.267,0.966,1.39,0.271,0.721,0.491,0.526,0.342,0.467,0.718,0.254,0.962,0.173,0.699,0.334,0.189,0.867,0.411,0.231,0.767,0.698,0.324,0.153,0.443,0.261,0.761,0.255,0.323,0.356,0.325,0.283,0.801,0.287,0.336,0.247,0.199,0.543,0.192,0.588,0.223,0.759,0.404,0.496,0.452,0.261,0.403,0.361,0.356,0.647,0.08799999999999999,0.597,0.532,0.159,0.318,0.237,1.4,0.399,1.189,0.6870000000000001,0.637,0.833,0.229,0.8169999999999999,0.204,0.167,0.722,0.495,0.542,0.678,0.37,0.719,0.319,0.725,0.615,1.321,0.64,0.361,0.374,0.395,0.678,0.905,0.15,0.235,0.324,0.605,0.289,0.431,0.26,0.742,0.514,0.464,1.072,0.6870000000000001,0.666,0.101,2.329,0.089,0.238,0.583,0.293,0.586,0.446,1.318,0.329,0.427,0.282,0.249,0.926,0.655,1.353,0.299,0.997,0.128,0.422,0.677,0.454,0.881,0.28,0.262,0.647,0.619,0.8080000000000001,0.34,0.263,0.434,0.757,1.224,0.613,0.6919999999999999,0.337,0.52,0.412,0.422,0.156,0.215,0.326,0.143,1.391,0.875,0.605,0.433,0.626,0.315,0.284,0.15,0.527,0.731,0.123,0.6919999999999999,0.127,0.122,0.166,0.26,0.259,0.893,0.472,0.673,0.349,0.654,0.279,0.58,0.962,0.378,0.875,0.583,0.385,0.499,0.306,0.234,2.137,0.545,0.225,0.8159999999999999,0.528,0.299,0.509,1.021,0.821,0.947,1.268,0.221,0.205,0.452,0.949,0.444,0.389,0.463,1.6,0.944,0.286,0.52,0.702,0.528,1.076,0.256,0.534,0.258,0.219,0.507,0.5610000000000001,0.496,0.516,0.264,0.328,0.284,0.233,0.551,0.527,0.497,0.23,2.42,0.658,0.33,0.51,0.285,0.415,0.381,0.498,0.364,1.001,0.46,0.733,0.705,0.452,0.269,0.6,0.571,0.711,0.466,0.162,0.344,0.306,0.233,0.365,0.536,1.159,0.629,1.144,0.547,0.163,0.839,0.313,0.738,0.314,0.6919999999999999,0.968,0.207,0.154,0.268,0.771,0.582,0.187,0.305,0.299,0.107,0.493,0.717,0.917,1.251,0.804,0.968,0.661,0.549,0.159,0.365,0.423,1.034,0.16,0.341,0.591,0.422,0.471,0.161,0.502,0.401,0.497,0.748,0.412,0.08500000000000001,0.338,0.203,0.43,0.198,0.892,0.28,0.8129999999999999,0.6870000000000001,1.154,0.175,1.699,0.733,0.6820000000000001,0.5590000000000001,0.407,0.6919999999999999,1.258,0.482,0.27,0.138,0.292,0.593,0.787,0.5570000000000001,0.257,0.246,0.347,0.362,0.238,0.115,0.649,0.871,0.149,0.695,0.73,0.134,0.447,0.455,0.26,0.234,0.466,0.269,0.142,0.24,0.155,1.162,1.292,0.165,0.637,0.217,0.43,0.164,0.631,0.285,0.88,0.614,0.332,0.366,0.591,0.828,0.335,0.886,0.439,0.128,0.268,0.598,0.483,0.118,0.176,0.674,0.295,0.439,0.352,0.826,0.97,0.415,0.289,0.349,0.251,0.496,0.323,0.646,0.426,0.515,0.453,0.785,0.4,0.219,1.174,0.488,1.096,0.408,0.261,0.222,1.057,0.766,0.171,0.245],[21,33,26,53,59,51,31,33,32,27,51,41,22,57,28,22,33,56,26,54,22,26,30,58,42,41,31,22,24,25,27,28,26,23,36,27,26,43,34,42,21,40,22,23,31,24,21,37,25,24,24,46,23,39,21,25,23,26,30,23,40,33,30,26,31,21,22,28,22,23,34,24,42,23,21,23,22,47,45,27,41,29,29,23,33,36,26,23,60,33,31,25,40,29,23,26,29,27,55,57,21,24,36,38,25,32,21,61,26,22,31,24,46,22,23,51,22,33,29,23,34,24,44,24,51,34,43,21,21,25,23,22,39,37,51,34,29,26,33,21,25,31,24,28,29,24,46,25,35,29,47,21,25,30,22,27,25,26,30,28,31,43,24,30,23,37,25,22,26,33,22,36,49,22,26,24,28,48,29,29,30,30,22,45,25,21,25,28,58,22,22,35,24,21,25,25,24,58,28,42,21,37,25,39,35,26,28,25,22,21,21,22,28,26,21,21,36,31,38,26,43,38,22,22,24,25,28,26,22,26,23,25,24,24,51,81,48,39,21,22,25,27,29,31,39,35,28,23,24,21,58,24,45,25,55,39,21,41,35,21,21,21,24,28,53,60,25,26,21,24,22,22,29,24,23,32,43,27,25,29,37,53,28,50,25,23,28,37,28,24,32,22,21,46,37,33,22,22,23,25,35,52,52,24,25,34,22,21,26,54,22,25,27,23,24,36,40,50,23,28,21,29,24,22,23,32,28,27,27,30,33,22,42,23,27,28,22,25,22,41,27,43,40,24,43,45,49,47,22,23,22,22,25,23,46,23,43,43,31,28,26,27,22,23,24,40,21,34,31,24,21,42,42,25,34,24,22,21,21,48,26,22,39,46,32,36,28,26,37,22,63,30],["neg","pos","pos","pos","pos","pos","pos","neg","pos","neg","pos","pos","neg","neg","pos","neg","neg","pos","neg","pos","neg","neg","neg","pos","neg","pos","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","pos","pos","pos","neg","pos","neg","pos","neg","pos","neg","neg","pos","pos","pos","neg","neg","neg","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","pos","neg","neg","pos","neg","pos","neg","neg","pos","pos","neg","pos","pos","pos","pos","neg","pos","pos","pos","pos","neg","neg","pos","neg","pos","pos","pos","pos","neg","pos","neg","neg","neg","neg","neg","pos","neg","neg","pos","neg","pos","neg","neg","neg","neg","pos","neg","pos","neg","neg","neg","neg","neg","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","pos","pos","pos","neg","pos","neg","pos","pos","neg","neg","pos","neg","pos","pos","neg","pos","neg","neg","neg","neg","neg","pos","neg","pos","pos","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","pos","neg","pos","pos","neg","neg","neg","pos","pos","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","pos","neg","pos","neg","neg","neg","pos","pos","pos","neg","neg","neg","pos","pos","pos","neg","pos","neg","neg","neg","neg","pos","neg","neg","pos","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","neg","pos","neg","neg","pos","neg","neg","pos","neg","neg","neg","pos","neg","pos","neg","neg","neg","pos","neg","neg","neg","neg","pos","pos","neg","neg","neg","neg","neg","neg","neg","neg","neg","neg","pos","pos","pos","neg","neg","pos","pos","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","neg","pos","pos","neg","neg","neg","pos","neg","neg","pos","pos","neg","neg","neg","neg","pos","pos","pos","neg","neg","neg","neg","neg","neg","neg","pos","neg","neg","neg","neg","pos","pos","pos","neg","neg","neg","neg","pos","neg","neg","pos","pos","pos","neg","neg","neg","neg","neg","neg","neg","neg","neg","neg","neg","pos","neg","pos","pos","pos","neg","neg","neg","neg","pos","neg","neg","neg","pos","pos","neg","neg","pos","neg","neg","pos","pos","neg","neg","neg","pos","neg","neg","neg","neg","neg","pos","neg","pos","pos","neg","neg","neg"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>pregnant<\/th>\n      <th>glucose<\/th>\n      <th>pressure<\/th>\n      <th>triceps<\/th>\n      <th>insulin<\/th>\n      <th>mass<\/th>\n      <th>pedigree<\/th>\n      <th>age<\/th>\n      <th>diabetes<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":[{"extend":"csv","text":"Download CSV ⬇","filename":"data"}],"searching":false,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dataset-import" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Dataset import<a class="anchor" aria-label="anchor" href="#dataset-import"><i class="fas fa-link"></i></a>
</h2>
<p>First prepare your data set similar to above and save it as a csv file. Then import the data set in to R. See chapter <a href="import.html#import">2</a>to know how to save a csv file and import it to R. Also you can directly use the code below to import dataset from your computer to R.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"path to your file"</span>, row.names<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#your file will be saved in the name data</span></span></code></pre></div>
<p>Please note the path copied from your system will be in the format <code>C:\Users\HP\Documents\</code>, change it to this format <code>C:/Users/HP/Documents/</code> in R.</p>
<p>Now fit the model</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="co"># Summarize the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>  </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(diabetes) ~ ., family = binomial, data = data)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.004e+01  1.218e+00  -8.246  &lt; 2e-16 ***
## pregnant     8.216e-02  5.543e-02   1.482  0.13825    
## glucose      3.827e-02  5.768e-03   6.635 3.24e-11 ***
## pressure    -1.420e-03  1.183e-02  -0.120  0.90446    
## triceps      1.122e-02  1.708e-02   0.657  0.51128    
## insulin     -8.253e-04  1.306e-03  -0.632  0.52757    
## mass         7.054e-02  2.734e-02   2.580  0.00989 ** 
## pedigree     1.141e+00  4.274e-01   2.669  0.00760 ** 
## age          3.395e-02  1.838e-02   1.847  0.06474 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 498.10  on 391  degrees of freedom
## Residual deviance: 344.02  on 383  degrees of freedom
## AIC: 362.02
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div id="viewing-results" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Viewing results<a class="anchor" aria-label="anchor" href="#viewing-results"><i class="fas fa-link"></i></a>
</h3>
<p>Viewing the results in a better way.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leifeld/texreg/">texreg</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/texreg/man/screenreg.html">screenreg</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>  </span></code></pre></div>
<pre><code>## 
## ===========================
##                 Model 1    
## ---------------------------
## (Intercept)      -10.04 ***
##                   (1.22)   
## pregnant           0.08    
##                   (0.06)   
## glucose            0.04 ***
##                   (0.01)   
## pressure          -0.00    
##                   (0.01)   
## triceps            0.01    
##                   (0.02)   
## insulin           -0.00    
##                   (0.00)   
## mass               0.07 ** 
##                   (0.03)   
## pedigree           1.14 ** 
##                   (0.43)   
## age                0.03    
##                   (0.02)   
## ---------------------------
## AIC              362.02    
## BIC              397.76    
## Log Likelihood  -172.01    
## Deviance         344.02    
## Num. obs.        392       
## ===========================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
<div id="interpretation" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"><i class="fas fa-link"></i></a>
</h3>
<p>The analysis of the logistic regression model reveals that out of the eight predictors considered, only three show statistically significant associations with the outcome variable. These significant predictors are glucose, pedigree and mass.<br>
When a logistic regression is calculated, the regression coefficient (b1) is the estimated increase in the log odds of the outcome per unit increase in the value of the variable (x1). For the variable “glucose,” which has a positive coefficient estimate of b = 0.04, an increase in glucose is associated with an increased probability of being diabetes-positive. This means that higher glucose levels tend to indicate a higher likelihood of diabetes.</p>
</div>
<div id="odds-ratio-or" class="section level3" number="6.2.3">
<h3>
<span class="header-section-number">6.2.3</span> Odds ratio (OR)<a class="anchor" aria-label="anchor" href="#odds-ratio-or"><i class="fas fa-link"></i></a>
</h3>
<p>The OR represents the odds that an outcome will occur in the presence of a particular variable, compared to the odds of the outcome occurring in the absence of that particular variable.</p>
<ul>
<li><p>OR=1 Variable does not affect odds of outcome</p></li>
<li><p>OR&gt;1 Variable associated with higher odds of outcome</p></li>
<li><p>OR&lt;1 Variable associated with lower odds of outcome<br>
Odds ratio is calculated as the the exponential function of the regression coefficient <span class="math inline">\(e^{b_1}\)</span>.</p></li>
</ul>
<p>For instance, the regression coefficient for “glucose” being 0.04 indicates that a one-unit increase in glucose concentration increases the odds of being diabetes-positive by a factor of exp(0.042), which is approximately 1.04 times.</p>
</div>
<div id="model-comparisons" class="section level3" number="6.2.4">
<h3>
<span class="header-section-number">6.2.4</span> Model comparisons<a class="anchor" aria-label="anchor" href="#model-comparisons"><i class="fas fa-link"></i></a>
</h3>
<div id="akaike-information-criteria-aic" class="section level4" number="6.2.4.1">
<h4>
<span class="header-section-number">6.2.4.1</span> Akaike Information Criteria (AIC)<a class="anchor" aria-label="anchor" href="#akaike-information-criteria-aic"><i class="fas fa-link"></i></a>
</h4>
<p>The AIC is a measure of the goodness of fit of a statistical model. It is commonly used for model selection when comparing several models to determine which one is the best fit for a given dataset. Lower AIC values indicate a better balance between model fit and simplicity.</p>
</div>
<div id="bayesian-information-criterion-bic" class="section level4" number="6.2.4.2">
<h4>
<span class="header-section-number">6.2.4.2</span> Bayesian Information Criterion (BIC)<a class="anchor" aria-label="anchor" href="#bayesian-information-criterion-bic"><i class="fas fa-link"></i></a>
</h4>
<p>The BIC is a similar measure to the AIC but places a stronger penalty on complex models. It is used for model selection, much like the AIC. The BIC considers both model fit and model complexity and is often preferred when you want to prevent overfitting and select a simpler model.</p>
</div>
<div id="log-likelihood" class="section level4" number="6.2.4.3">
<h4>
<span class="header-section-number">6.2.4.3</span> log-likelihood<a class="anchor" aria-label="anchor" href="#log-likelihood"><i class="fas fa-link"></i></a>
</h4>
<p>The log-likelihood is a fundamental component of both AIC and BIC. It represents the logarithm of the likelihood of the data given the model, which measures how well the model explains the observed data. It is often used to compare the fit of different models, where a higher log-likelihood indicates a better fit to the data.</p>
</div>
<div id="deviance-measures" class="section level4" number="6.2.4.4">
<h4>
<span class="header-section-number">6.2.4.4</span> Deviance measures<a class="anchor" aria-label="anchor" href="#deviance-measures"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Null deviance</strong> : is a measure of the model’s goodness of fit when only the intercept (no predictor variables) is included in the model. It represents the deviance when your model contains no explanatory variables and is essentially a null model.
In our example, the null deviance is 498.10, and it is calculated on 391 degrees of freedom.
<strong>Residual Deviance</strong>:
The residual deviance is a measure of the model’s goodness of fit when predictor variables are included. It quantifies the deviance of the model from the observed data after adjusting for the parameters in the model. In our example, the residual deviance is 344.02, and it is calculated on 383 degrees of freedom.</p>
</div>
</div>
</div>
<div id="fitting-a-better-model" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Fitting a better model<a class="anchor" aria-label="anchor" href="#fitting-a-better-model"><i class="fas fa-link"></i></a>
</h2>
<p>From the logistic regression results, it can be noticed that some variables - pregnent, triceps, insulin and age - are not statistically significant. Keeping them in the model may contribute to overfitting. Therefore, they should be eliminated. A better model can be fitted as below.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span><span class="op">+</span><span class="va">glucose</span> <span class="op">+</span> <span class="va">mass</span> <span class="op">+</span> <span class="va">pedigree</span><span class="op">+</span><span class="va">pregnant</span>, data <span class="op">=</span> <span class="va">data</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span><span class="co"># Summarize the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>  </span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = as.factor(diabetes) ~ age + glucose + mass + pedigree + 
##     pregnant, family = binomial, data = data)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -9.992080   1.086866  -9.193  &lt; 2e-16 ***
## age          0.034360   0.017810   1.929 0.053692 .  
## glucose      0.036458   0.004978   7.324 2.41e-13 ***
## mass         0.078139   0.020605   3.792 0.000149 ***
## pedigree     1.150913   0.424242   2.713 0.006670 ** 
## pregnant     0.083953   0.055031   1.526 0.127117    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 498.10  on 391  degrees of freedom
## Residual deviance: 344.89  on 386  degrees of freedom
## AIC: 356.89
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>In the new model you can see AIC is reduced to 356.89 when compared to previous model AIC of 362.</p>
</div>
<div id="saving-results-to-csv" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Saving results to csv<a class="anchor" aria-label="anchor" href="#saving-results-to-csv"><i class="fas fa-link"></i></a>
</h2>
<p>You can use the code below to save the results as csv.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract coefficients, standard errors, and p-values</span></span>
<span><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Estimate"</span>, <span class="st">"Std. Error"</span>, <span class="st">"Pr(&gt;|z|)"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Rename the columns for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">coef</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coefficient"</span>, <span class="st">"Std.Error"</span>, <span class="st">"P.Value"</span><span class="op">)</span></span>
<span><span class="co"># write to csv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">coef</span>, <span class="st">"result_logit.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="plotting-logistic-curve" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Plotting logistic curve<a class="anchor" aria-label="anchor" href="#plotting-logistic-curve"><i class="fas fa-link"></i></a>
</h2>
<p>You can draw a logistic curve for single variable models like below using the code.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>  </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">diabetes</span> <span class="op">==</span> <span class="st">"pos"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">glucose</span>, <span class="va">prob</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span>, method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Logistic Regression Model"</span>, </span>
<span>    x <span class="op">=</span> <span class="st">"Glucose"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probability of being diabetic"</span></span>
<span>    <span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="lecture_note_files/figure-html/plot_model-1.png" width="672"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cluster-analysis.html"><span class="header-section-number">5</span> Cluster Analysis</a></div>
<div class="next"><a href="canonical-correlation.html"><span class="header-section-number">7</span> Canonical Correlation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#logistic-regression"><span class="header-section-number">6</span> Logistic Regression</a></li>
<li><a class="nav-link" href="#practical-example-2"><span class="header-section-number">6.1</span> Practical Example</a></li>
<li>
<a class="nav-link" href="#dataset-import"><span class="header-section-number">6.2</span> Dataset import</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#viewing-results"><span class="header-section-number">6.2.1</span> Viewing results</a></li>
<li><a class="nav-link" href="#interpretation"><span class="header-section-number">6.2.2</span> Interpretation</a></li>
<li><a class="nav-link" href="#odds-ratio-or"><span class="header-section-number">6.2.3</span> Odds ratio (OR)</a></li>
<li><a class="nav-link" href="#model-comparisons"><span class="header-section-number">6.2.4</span> Model comparisons</a></li>
</ul>
</li>
<li><a class="nav-link" href="#fitting-a-better-model"><span class="header-section-number">6.3</span> Fitting a better model</a></li>
<li><a class="nav-link" href="#saving-results-to-csv"><span class="header-section-number">6.4</span> Saving results to csv</a></li>
<li><a class="nav-link" href="#plotting-logistic-curve"><span class="header-section-number">6.5</span> Plotting logistic curve</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>MULTIVARIATE DATA ANALYSIS TOOLS FOR AGRICULTURAL RESEARCH</strong>" was written by Dr. PRATHEESH P GOPINATH. It was last built on 2023-10-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
